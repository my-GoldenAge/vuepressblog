(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{709:function(s,t,a){s.exports=a.p+"assets/img/image-20220414135431616.4da17802.png"},710:function(s,t){s.exports="data:image/png;base64,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"},711:function(s,t,a){s.exports=a.p+"assets/img/BlockingQueue和BlockingDeque的区别.79912b77.png"},765:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),n("p",[s._v("并发容器之BlockingQueue")])]),s._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#_1、blockingqueue简介"}},[s._v("1、BlockingQueue简介")])]),n("li",[n("a",{attrs:{href:"#_2、基本操作"}},[s._v("2、基本操作")])]),n("li",[n("a",{attrs:{href:"#_3、常用的blockingqueue"}},[s._v("3、常用的BlockingQueue")])]),n("li",[n("a",{attrs:{href:"#_4、arrayblockingqueue"}},[s._v("4、ArrayBlockingQueue")]),n("ul",[n("li",[n("a",{attrs:{href:"#_4-1-arrayblockingqueue简介"}},[s._v("4.1 ArrayBlockingQueue简介")])]),n("li",[n("a",{attrs:{href:"#_4-2-arrayblockingqueue实现原理"}},[s._v("4.2 ArrayBlockingQueue实现原理")])]),n("li",[n("a",{attrs:{href:"#_4-3-arrayblockingqueue的主要属性"}},[s._v("4.3 ArrayBlockingQueue的主要属性")])]),n("li",[n("a",{attrs:{href:"#_4-4-put方法详解"}},[s._v("4.4 put方法详解")])]),n("li",[n("a",{attrs:{href:"#_4-5-take方法详解"}},[s._v("4.5 take方法详解")])])])]),n("li",[n("a",{attrs:{href:"#_5、linkedblockingqueue"}},[s._v("5、LinkedBlockingQueue")]),n("ul",[n("li",[n("a",{attrs:{href:"#_5-1-linkedblockingqueue的主要属性"}},[s._v("5.1 LinkedBlockingQueue的主要属性")])]),n("li",[n("a",{attrs:{href:"#_5-2-put方法详解"}},[s._v("5.2 put方法详解")])])])]),n("li",[n("a",{attrs:{href:"#_6、两个阻塞队列的比较"}},[s._v("6、两个阻塞队列的比较")])])])]),n("p"),s._v(" "),n("h1",{attrs:{id:"并发容器之blockingqueue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#并发容器之blockingqueue"}},[s._v("#")]),s._v(" 并发容器之BlockingQueue")]),s._v(" "),n("h2",{attrs:{id:"_1、blockingqueue简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、blockingqueue简介"}},[s._v("#")]),s._v(" 1、BlockingQueue简介")]),s._v(" "),n("p",[s._v("在实际编程中，会经常使用到JDK中Collection集合框架中的各种容器类如实现List,Map,Queue接口的容器类，但是这些容器类基本上不是线程安全的，除了使用Collections可以将其转换为线程安全的容器，Doug Lea大师为我们都准备了对应的线程安全的容器，如实现List接口的CopyOnWriteArrayList，实现Map接口的ConcurrentHashMap，实现Queue接口的ConcurrentLinkedQueue。")]),s._v(" "),n("p",[s._v('最常用的"'),n("strong",[s._v("生产者-消费者")]),s._v('"问题中，队列通常被视作线程间操作的数据容器，这样，可以对各个模块的业务功能进行解耦，生产者将“生产”出来的数据放置在数据容器中，而消费者仅仅只需要在“数据容器”中进行获取数据即可，这样生产者线程和消费者线程就能够进行解耦，只专注于自己的业务功能即可。阻塞队列（BlockingQueue）被广泛使用在“生产者-消费者”问题中，其原因是BlockingQueue提供了可阻塞的插入和移除的方法。'),n("strong",[s._v("当队列容器已满，生产者线程会被阻塞，直到队列未满；当队列容器为空时，消费者线程会被阻塞，直至队列非空时为止。")])]),s._v(" "),n("h2",{attrs:{id:"_2、基本操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、基本操作"}},[s._v("#")]),s._v(" 2、基本操作")]),s._v(" "),n("p",[s._v("插入和移除操作的4种处理方式：")]),s._v(" "),n("p",[n("img",{attrs:{src:a(709),alt:"image-20220414135431616"}})]),s._v(" "),n("ul",[n("li",[s._v('抛出异常：当队列满时，如果再往队列里插入元素，会抛出IllegalStateException（"Queue full"）异常。当队列空时，从队列里获取元素会抛出NoSuchElementException异常。')]),s._v(" "),n("li",[s._v("返回特殊值：当往队列插入元素时，会返回元素是否插入成功，成功返回true。如果是移除方法，则是从队列里取出一个元素，如果没有则返回null。")]),s._v(" "),n("li",[s._v("一直阻塞：当阻塞队列满时，如果生产者线程往队列里put元素，队列会一直阻塞生产者线程，直到队列可用或者响应中断退出。当队列空时，如果消费者线程从队列里take元素，队列会阻塞住消费者线程，直到队列不为空。")]),s._v(" "),n("li",[s._v("超时退出：当阻塞队列满时，如果生产者线程往队列里插入元素，队列会阻塞生产者线程一段时间，如果超过了指定的时间，生产者线程就会退出。")])]),s._v(" "),n("h2",{attrs:{id:"_3、常用的blockingqueue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、常用的blockingqueue"}},[s._v("#")]),s._v(" 3、常用的BlockingQueue")]),s._v(" "),n("p",[s._v("实现BlockingQueue接口的有"),n("code",[s._v("ArrayBlockingQueue, DelayQueue, LinkedBlockingDeque, LinkedBlockingQueue, LinkedTransferQueue, PriorityBlockingQueue, SynchronousQueue")]),s._v("，而这几种常见的阻塞队列也是在实际编程中会常用的，下面对这几种常见的阻塞队列进行说明：")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("ArrayBlockingQueue")])])]),s._v(" "),n("p",[n("strong",[s._v("ArrayBlockingQueue")]),s._v("是由数组实现的有界阻塞队列。该队列命令元素FIFO（先进先出）。因此，队头元素是队列中存在时间最长的数据元素，而对尾数据则是当前队列最新的数据元素。ArrayBlockingQueue可作为“有界数据缓冲区”，生产者插入数据到队列容器中，并由消费者提取。ArrayBlockingQueue一旦创建，容量不能改变。")]),s._v(" "),n("p",[s._v("当队列容量满时，尝试将元素放入队列将导致操作阻塞；尝试从一个空队列中取一个元素也会同样阻塞。")]),s._v(" "),n("p",[s._v("ArrayBlockingQueue默认情况下不能保证线程访问队列的公平性，所谓公平性是指严格按照线程等待的绝对时间顺序，即最先等待的线程能够最先访问到ArrayBlockingQueue。而非公平性则是指访问ArrayBlockingQueue的顺序不是遵守严格的时间顺序，有可能存在，一旦ArrayBlockingQueue可以被访问时，长时间阻塞的线程依然无法访问到ArrayBlockingQueue。"),n("strong",[s._v("如果保证公平性，通常会降低吞吐量")]),s._v("。如果需要获得公平性的ArrayBlockingQueue，可采用如下代码：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayBlockingQueue")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" blockingQueue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayBlockingQueue")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("访问者的公平性是使用可重入锁实现的，代码如下：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayBlockingQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" fair"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IllegalArgumentException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    lock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fair"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    notEmpty "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCondition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    notFull "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCondition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("关于ArrayBlockingQueue的实现原理，可以"),n("a",{attrs:{href:"https://juejin.im/post/5aeebdb26fb9a07aa83ea17e",target:"_blank",rel:"noopener noreferrer"}},[s._v("看这篇文章"),n("OutboundLink")],1),s._v("。")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("LinkedBlockingQueue")])])]),s._v(" "),n("p",[s._v("LinkedBlockingQueue是用链表实现的有界阻塞队列，同样满足FIFO的特性，与ArrayBlockingQueue相比起来具有更高的吞吐量，为了防止LinkedBlockingQueue容量迅速增，损耗大量内存。通常在创建LinkedBlockingQueue对象时，会指定其大小，如果未指定，容量等于Integer.MAX_VALUE")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("PriorityBlockingQueue")])])]),s._v(" "),n("p",[s._v("PriorityBlockingQueue是一个支持优先级的无界阻塞队列。默认情况下元素采用自然顺序进行排序，也可以通过自定义类实现compareTo()方法来指定元素排序规则，或者初始化时通过构造器参数Comparator来指定排序规则。")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("SynchronousQueue")])])]),s._v(" "),n("p",[s._v("SynchronousQueue每个插入操作必须等待另一个线程进行相应的删除操作，因此，SynchronousQueue实际上没有存储任何数据元素，因为只有线程在删除数据时，其他线程才能插入数据，同样的，如果当前有线程在插入数据时，线程才能删除数据。SynchronousQueue也可以通过构造器参数来为其指定公平性。")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("LinkedTransferQueue")])])]),s._v(" "),n("p",[s._v("LinkedTransferQueue是一个由链表数据结构构成的无界阻塞队列，由于该队列实现了TransferQueue接口，与其他阻塞队列相比主要有以下不同的方法：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("transfer(E e)")]),s._v("：如果当前有线程（消费者）正在调用take()方法或者可延时的poll()方法进行消费数据时，生产者线程可以调用transfer方法将数据传递给消费者线程。如果当前没有消费者线程的话，生产者线程就会将数据插入到队尾，直到有消费者能够进行消费才能退出；")]),s._v(" "),n("li",[n("code",[s._v("tryTransfer(E e)")]),s._v("：tryTransfer方法如果当前有消费者线程（调用take方法或者具有超时特性的poll方法）正在消费数据的话，该方法可以将数据立即传送给消费者线程，如果当前没有消费者线程消费数据的话，就立即返回"),n("code",[s._v("false")]),s._v("。因此，与transfer方法相比，transfer方法是必须等到有消费者线程消费数据时，生产者线程才能够返回。而tryTransfer方法能够立即返回结果退出。")]),s._v(" "),n("li",[n("code",[s._v("tryTransfer(E e,long timeout,imeUnit unit)")]),s._v("：与transfer基本功能一样，只是增加了超时特性，如果数据才规定的超时时间内没有消费者进行消费的话，就返回"),n("code",[s._v("false")]),s._v("。")])]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("LinkedBlockingDeque")])])]),s._v(" "),n("p",[s._v("LinkedBlockingDeque是基于链表数据结构的有界阻塞双端队列，如果在创建对象时为指定大小时，其默认大小为Integer.MAX_VALUE。与LinkedBlockingQueue相比，主要的不同点在于，LinkedBlockingDeque具有双端队列的特性。LinkedBlockingDeque基本操作如下图所示：")]),s._v(" "),n("p",[n("img",{attrs:{src:a(710),alt:"BlockingQueue基本操作.png"}})]),s._v(" "),n("p",[s._v("如上图所示，LinkedBlockingDeque的基本操作可以分为四种类型：1.特殊情况，抛出异常；2.特殊情况，返回特殊值如null或者false；3.当线程不满足操作条件时，线程会被阻塞直至条件满足；4. 操作具有超时特性。")]),s._v(" "),n("p",[s._v("另外，LinkedBlockingDeque实现了BlockingDueue接口而LinkedBlockingQueue实现的是BlockingQueue，这两个接口的主要区别如下图所示：")]),s._v(" "),n("p",[n("img",{attrs:{src:a(711),alt:"BlockingQueue和BlockingDeque的区别.png"}})]),s._v(" "),n("p",[s._v("从上图可以看出，两个接口的功能是可以等价使用的，比如BlockingQueue的add方法和BlockingDeque的addLast方法的功能是一样的。")]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("DelayQueue")])])]),s._v(" "),n("p",[s._v("DelayQueue是一个存放实现Delayed接口的数据的无界阻塞队列，只有当数据对象的延时时间达到时才能插入到队列进行存储。如果当前所有的数据都还没有达到创建时所指定的延时期，则队列没有队头，并且线程通过poll等方法获取数据元素则返回null。所谓数据延时期满时，则是通过Delayed接口的"),n("code",[s._v("getDelay(TimeUnit.NANOSECONDS)")]),s._v("来进行判定，如果该方法返回的是小于等于0则说明该数据元素的延时期已满。")]),s._v(" "),n("h2",{attrs:{id:"_4、arrayblockingqueue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、arrayblockingqueue"}},[s._v("#")]),s._v(" 4、ArrayBlockingQueue")]),s._v(" "),n("h3",{attrs:{id:"_4-1-arrayblockingqueue简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-arrayblockingqueue简介"}},[s._v("#")]),s._v(" 4.1 ArrayBlockingQueue简介")]),s._v(" "),n("p",[s._v("在多线程编程过程中，为了业务解耦和架构设计，经常会使用并发容器用于存储多线程间的共享数据，这样不仅可以保证线程安全，还可以简化各个线程操作。例如在“生产者-消费者”问题中，会使用阻塞队列（BlockingQueue）作为数据容器。为了加深对阻塞队列的理解，唯一的方式是对其实验原理进行理解，这篇文章就主要来看看ArrayBlockingQueue和LinkedBlockingQueue的实现原理。")]),s._v(" "),n("h3",{attrs:{id:"_4-2-arrayblockingqueue实现原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-arrayblockingqueue实现原理"}},[s._v("#")]),s._v(" 4.2 ArrayBlockingQueue实现原理")]),s._v(" "),n("p",[s._v("阻塞队列最核心的功能是，能够可阻塞式的插入和删除队列元素。当前队列为空时，会阻塞消费数据的线程，直至队列非空时，通知被阻塞的线程；当队列满时，会阻塞插入数据的线程，直至队列未满时，通知插入数据的线程（生产者线程）。那么，多线程中消息通知机制最常用的是lock的condition机制，关于condition可以看前面文章的详细介绍。那么ArrayBlockingQueue的实现是不是也会采用Condition的通知机制呢？下面来看看。")]),s._v(" "),n("h3",{attrs:{id:"_4-3-arrayblockingqueue的主要属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-arrayblockingqueue的主要属性"}},[s._v("#")]),s._v(" 4.3 ArrayBlockingQueue的主要属性")]),s._v(" "),n("p",[s._v("ArrayBlockingQueue的主要属性如下:")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** The queued items */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** items index for next take, poll, peek or remove */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" takeIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** items index for next put, offer, or add */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" putIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Number of elements in the queue */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n * Concurrency control uses the classic two-condition algorithm\n * found in any textbook.\n */")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Main lock guarding all access */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Condition for waiting takes */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Condition")]),s._v(" notEmpty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Condition for waiting puts */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Condition")]),s._v(" notFull"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("p",[s._v("从源码中可以看出ArrayBlockingQueue内部是采用数组进行数据存储的（"),n("code",[s._v("items")]),s._v("），为了保证线程安全，采用的是"),n("code",[s._v("ReentrantLock lock")]),s._v("，为了保证可阻塞式的插入删除数据利用的是Condition，当获取数据的消费者线程被阻塞时会将该线程放置到notEmpty等待队列中，当插入数据的生产者线程被阻塞时，会将该线程放置到notFull等待队列中。而notEmpty和notFull等中要属性在构造方法中进行创建：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayBlockingQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" fair"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("capacity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IllegalArgumentException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    lock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fair"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    notEmpty "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCondition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    notFull "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCondition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("接下来，主要看看可阻塞式的put和take方法是怎样实现的。")]),s._v(" "),n("h3",{attrs:{id:"_4-4-put方法详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-put方法详解"}},[s._v("#")]),s._v(" 4.4 put方法详解")]),s._v(" "),n("p",[n("code",[s._v("put(E e)")]),s._v("方法源码如下：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkNotNull")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" lock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lockInterruptibly")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//如果当前队列已满，将线程移入到notFull等待队列中")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            notFull"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//满足插入数据的要求，直接进行入队操作")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("enqueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("该方法的逻辑很简单，当队列已满时（"),n("code",[s._v("count == items.length")]),s._v("）将线程移入到notFull等待队列中，如果当前满足插入数据的条件，就可以直接调用"),n("code",[s._v("enqueue(e)")]),s._v("插入数据元素。enqueue方法源码为：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("enqueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// assert lock.getHoldCount() == 1;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// assert items[putIndex] == null;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" items "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//插入数据")]),s._v("\n    items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("putIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("putIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        putIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    count"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通知消费者线程，当前队列中有数据可供消费")]),s._v("\n    notEmpty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("signal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("enqueue方法的逻辑同样也很简单，先完成插入数据，即往数组中添加数据（"),n("code",[s._v("items[putIndex] = x")]),s._v("），然后通知被阻塞的消费者线程，当前队列中有数据可供消费（"),n("code",[s._v("notEmpty.signal()")]),s._v("）。")]),s._v(" "),n("h3",{attrs:{id:"_4-5-take方法详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-take方法详解"}},[s._v("#")]),s._v(" 4.5 take方法详解")]),s._v(" "),n("p",[s._v("take方法源码如下：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("take")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" lock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lockInterruptibly")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//如果队列为空，没有数据，将消费者线程移入等待队列中")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            notEmpty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//获取数据")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dequeue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        lock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("take方法也主要做了两步：1. 如果当前队列为空的话，则将获取数据的消费者线程移入到等待队列中；2. 若队列不为空则获取数据，即完成出队操作"),n("code",[s._v("dequeue")]),s._v("。dequeue方法源码为：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dequeue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// assert lock.getHoldCount() == 1;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// assert items[takeIndex] != null;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" items "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SuppressWarnings")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unchecked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//获取数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" x "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("takeIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("takeIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("takeIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" items"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        takeIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    count"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("itrs "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        itrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("elementDequeued")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通知被阻塞的生产者线程")]),s._v("\n\tnotFull"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("signal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[s._v("dequeue方法也主要做了两件事情：1. 获取队列中的数据，即获取数组中的数据元素（"),n("code",[s._v("(E) items[takeIndex]")]),s._v("）；2. 通知notFull等待队列中的线程，使其由等待队列移入到同步队列中，使其能够有机会获得lock，并执行完成功退出。")]),s._v(" "),n("p",[s._v("从以上分析，可以看出put和take方法主要是通过condition的通知机制来完成可阻塞式的插入数据和获取数据。在理解ArrayBlockingQueue后再去理解LinkedBlockingQueue就很容易了。")]),s._v(" "),n("h2",{attrs:{id:"_5、linkedblockingqueue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5、linkedblockingqueue"}},[s._v("#")]),s._v(" 5、LinkedBlockingQueue")]),s._v(" "),n("p",[s._v("LinkedBlockingQueue是用链表实现的有界阻塞队列，当构造对象时为指定队列大小时，队列默认大小为"),n("code",[s._v("Integer.MAX_VALUE")]),s._v("。从它的构造方法可以看出：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LinkedBlockingQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("MAX_VALUE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"_5-1-linkedblockingqueue的主要属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-linkedblockingqueue的主要属性"}},[s._v("#")]),s._v(" 5.1 LinkedBlockingQueue的主要属性")]),s._v(" "),n("p",[s._v("LinkedBlockingQueue的主要属性有：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Current number of elements */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicInteger")]),s._v(" count "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicInteger")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Head of linked list.\n * Invariant: head.item == null\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("transient")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Tail of linked list.\n * Invariant: last.next == null\n */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("transient")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" last"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Lock held by take, poll, etc */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" takeLock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Wait queue for waiting takes */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Condition")]),s._v(" notEmpty "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" takeLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCondition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Lock held by put, offer, etc */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" putLock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Wait queue for waiting puts */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Condition")]),s._v(" notFull "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" putLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCondition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("p",[s._v("可以看出与ArrayBlockingQueue主要的区别是，LinkedBlockingQueue在插入数据和删除数据时分别是由两个不同的lock（"),n("code",[s._v("takeLock")]),s._v("和"),n("code",[s._v("putLock")]),s._v("）来控制线程安全的，因此，也由这两个lock生成了两个对应的condition（"),n("code",[s._v("notEmpty")]),s._v("和"),n("code",[s._v("notFull")]),s._v("）来实现可阻塞的插入和删除数据。并且，采用了链表的数据结构来实现队列，Node结点的定义为：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * One of:\n     * - the real successor Node\n     * - this Node, meaning the successor is head.next\n     * - null, meaning there is no successor (this is the last node)\n     */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" item "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("接下来，我们也同样来看看put方法和take方法的实现。")]),s._v(" "),n("h3",{attrs:{id:"_5-2-put方法详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-put方法详解"}},[s._v("#")]),s._v(" 5.2 put方法详解")]),s._v(" "),n("p",[s._v("put方法源码为:")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NullPointerException")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Note: convention in all put/take/etc is to preset local var")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// holding count negative to indicate failure unless set.")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" node "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" putLock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("putLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicInteger")]),s._v(" count "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    putLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lockInterruptibly")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n         * Note that count is used in wait guard even though it is\n         * not protected by lock. This works because count can\n         * only decrease at this point (all other puts are shut\n         * out by lock), and we (or some other waiting put) are\n         * signalled if it ever changes from capacity. Similarly\n         * for all other uses of count in other wait guards.\n         */")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//如果队列已满，则阻塞当前线程，将其移入等待队列")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            notFull"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//入队操作，插入数据")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("enqueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getAndIncrement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//若队列满足插入数据的条件，则通知被阻塞的生产者线程")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            notFull"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("signal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        putLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("signalNotEmpty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br")])]),n("p",[s._v("put方法的逻辑也同样很容易理解，可见注释。基本上和ArrayBlockingQueue的put方法一样。take方法的源码如下：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("take")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("E")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicInteger")]),s._v(" count "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReentrantLock")]),s._v(" takeLock "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("takeLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    takeLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("lockInterruptibly")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//当前队列为空，则阻塞当前线程，将其移入到等待队列中，直至满足条件")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            notEmpty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("await")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//移除队头元素，获取数据")]),s._v("\n        x "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dequeue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getAndDecrement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//如果当前满足移除元素的条件，则通知被阻塞的消费者线程")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            notEmpty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("signal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        takeLock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlock")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" capacity"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("signalNotFull")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("p",[s._v("take方法的主要逻辑请见于注释，也很容易理解。")]),s._v(" "),n("h2",{attrs:{id:"_6、两个阻塞队列的比较"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6、两个阻塞队列的比较"}},[s._v("#")]),s._v(" 6、两个阻塞队列的比较")]),s._v(" "),n("p",[n("strong",[s._v("相同点")]),s._v("：")]),s._v(" "),n("p",[s._v("ArrayBlockingQueue和LinkedBlockingQueue都是通过condition通知机制来实现可阻塞式插入和删除元素，并满足线程安全的特性；")]),s._v(" "),n("p",[n("strong",[s._v("不同点")]),s._v("：")]),s._v(" "),n("ol",[n("li",[s._v("ArrayBlockingQueue底层是采用的数组进行实现，而LinkedBlockingQueue则是采用链表数据结构；")]),s._v(" "),n("li",[s._v("ArrayBlockingQueue插入和删除数据，只采用了一个lock，而LinkedBlockingQueue则是在插入和删除分别采用了"),n("code",[s._v("putLock")]),s._v("和"),n("code",[s._v("takeLock")]),s._v("，这样可以降低线程由于线程无法获取到lock而进入WAITING状态的可能性，从而提高了线程并发执行的效率。")])]),s._v(" "),n("blockquote",[n("p",[s._v("参考文献")])]),s._v(" "),n("p",[s._v("《Java并发编程的艺术》")])])}),[],!1,null,null,null);t.default=e.exports}}]);